{% extends 'base.html' %}
{% load static %}

{% block title %}{{ mehsul.adi }} - Məhsul Haqqında{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/mehsul_haqqinda.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<!-- Məhsul Məlumatları -->
<div class="mehsul-container">
    <!-- Naviqasiya və Geri Düyməsi -->
    <div class="navigation-bar">
        <a href="javascript:history.back()" class="back-button">
            <i class="fas fa-arrow-left"></i> Geri Qayıt
        </a>
        <div class="breadcrumbs">
            <a href="{% url 'home' %}">Ana Səhifə</a> / 
            <a href="{% url 'kateqoriya' mehsul.kateqoriya.slug %}">{{ mehsul.kateqoriya }}</a> / 
            <span>{{ mehsul.adi }}</span>
        </div>
    </div>

    <!-- Məhsul Əsas Məlumatları -->
    <div class="mehsul-info">
        <div class="mehsul-gallery">
            {% if mehsul.sekil %}
            <div class="model-viewer-container">
                <div class="zoom-hint">
                    <i class="fas fa-search-plus"></i> Şəkli böyütmək üçün klikləyin
                </div>
                <img src="{{ mehsul.sekil.url }}" alt="{{ mehsul.adi }}" class="product-image" id="productImage">
                <div class="image-controls">
                    <button class="rotate-button" id="rotateLeft"><i class="fas fa-undo"></i></button>
                    <button class="rotate-button" id="rotateRight"><i class="fas fa-redo"></i></button>
                </div>
            </div>
            {% endif %}
            
            <!-- Məhsul Qısa Məlumatları (Mobil üçün) -->
            <div class="mobile-product-summary">
                <h2>{{ mehsul.adi }}</h2>
                <div class="mobile-price-stock">
                    <span class="mobile-price">{{ mehsul.formatted_qiymet }} ₼</span>
                    <span class="stock-status {% if mehsul.stok == 0 %}out-of-stock{% elif mehsul.stok <= 20 %}low-stock{% else %}in-stock{% endif %}">
                        {% if mehsul.stok == 0 %}
                            <i class="fas fa-times-circle"></i> Yoxdur 
                        {% elif mehsul.stok <= 20 %}
                            <i class="fas fa-exclamation-circle"></i> Az var 
                        {% else %}
                            <i class="fas fa-check-circle"></i> Var 
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        
        <div class="mehsul-details">
            <div class="product-header">
                <h1>{{ mehsul.adi }}</h1>
                <div class="product-code">
                    <span class="code-label">Məhsul Kodu:</span>
                    <span class="code-value">{{ mehsul.id }}</span>
                </div>
            </div>
            
            <div class="specs">
                <div class="spec-item">
                    <span class="label"><i class="fas fa-tag"></i> Kateqoriya:</span>
                    <span class="value">{{ mehsul.kateqoriya }}</span>
                </div>
                <div class="spec-item">
                    <span class="label"><i class="fas fa-industry"></i> Firma:</span>
                    <span class="value" style="display: flex; align-items: center;">
                        {% if mehsul.brend.sekilyazi %}
                        <img src="{{ mehsul.brend.sekilyazi.url }}" alt="{{ mehsul.brend.adi }}" class="marka-image">
                        {% else %}
                            {{ mehsul.brend.adi }}
                        {% endif %}
                    </span>
                </div>
                <div class="spec-item">
                    <span class="label"><i class="fas fa-car"></i> Avtomobil:</span>
                    <span class="value" style="display: flex; align-items: center;">
                        {% if mehsul.marka.sekiller.all %}
                            {% for sekil in mehsul.marka.sekiller.all %}
                                <img src="{{ sekil.sekil.url }}" alt="{{ mehsul.marka.adi }}" class="marka-image-pr-list" style="margin-right: 8px;">
                            {% endfor %}
                        {% else %}
                            {{ mehsul.marka.adi }}
                        {% endif %}
                    </span>
                </div>
                <div class="spec-item">
                    <span class="label"><i class="fas fa-barcode"></i> Brend:</span>
                    <span class="value">{{ mehsul.brend_kod }}</span>
                </div>
                <div class="spec-item">
                    <span class="label"><i class="fas fa-hashtag"></i> OEM:</span>
                    <span class="value">{{ mehsul.oem }}</span>
                </div>
                <div class="spec-item stock-item">
                    <span class="label"><i class="fas fa-warehouse"></i> Mövcudluq:</span>
                    <span class="value stock-status {% if mehsul.stok == 0 %}out-of-stock{% elif mehsul.stok <= 20 %}low-stock{% else %}in-stock{% endif %}">
                        {% if mehsul.stok == 0 %}
                            <i class="fas fa-times-circle"></i> Yoxdur 
                        {% elif mehsul.stok <= 20 %}
                            <i class="fas fa-exclamation-circle"></i> Az var 
                        {% else %}
                            <i class="fas fa-check-circle"></i> Var 
                        {% endif %}
                    </span>
                </div>
                <div class="spec-item price-item">
                    <span class="label"><i class="fas fa-tag"></i> Qiymət:</span>
                    <span class="value price">{{ mehsul.formatted_qiymet }} ₼</span>
                </div>
            </div>

            <div class="action-buttons">
                <a href="{% url 'sebet_ekle' mehsul.id %}" class="cart-icon" data-product-id="{{ mehsul.id }}">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Səbətə Əlavə Et</span>
                </a>
                <button class="wishlist-button" data-product-id="{{ mehsul.id }}">
                    <i class="far fa-heart"></i>
                    <span>İstək Siyahısına Əlavə Et</span>
                </button>
            </div>
            
            <div class="delivery-info">
                <div class="delivery-item">
                    <i class="fas fa-truck"></i>
                    <span>Bakı daxili çatdırılma: 1-2 iş günü</span>
                </div>
                <div class="delivery-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>Zəmanət: 30 gün</span>
                </div>
                <div class="delivery-item">
                    <i class="fas fa-exchange-alt"></i>
                    <span>Geri qaytarma: 14 gün</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Məhsul Haqqında Ətraflı Məlumat -->
    <div class="product-tabs">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="description">Məhsul Haqqında</button>
            {% if mehsul.model.all %}
            <button class="tab-button" data-tab="compatibility">Uyğunluq</button>
            {% endif %}
            {% if mehsul.brend.haqqinda or mehsul.brend.sekil %}
            <button class="tab-button" data-tab="brand">Brend Haqqında</button>
            {% endif %}
        </div>
        
        <div class="tab-content">
            <div class="tab-pane active" id="description">
                {% if mehsul.haqqinda %}
                <div class="description">
                    <p>{{ mehsul.haqqinda }}</p>
                </div>
                {% else %}
                <div class="no-content">
                    <i class="fas fa-info-circle"></i>
                    <p>Bu məhsul haqqında ətraflı məlumat mövcud deyil.</p>
                </div>
                {% endif %}
            </div>
            
            {% if mehsul.model.all %}
            <div class="tab-pane" id="compatibility">
                <div class="compatibility-table">
                    <table>
                        <thead>
                            <tr>
                                <th><i class="fas fa-car"></i> Avtomobil</th>
                                <th><i class="fas fa-car-side"></i> Model</th>
                                <th><i class="fas fa-cogs"></i> Motor</th>
                                <th><i class="fas fa-gas-pump"></i> Yanacaq</th>
                                <th><i class="fas fa-calendar-alt"></i> İl</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for model in mehsul.model.all %}
                            <tr>
                                <td>{{ model.avtomobil.adi }}</td>
                                <td>{{ model.model.adi }}</td>
                                <td>{{ model.motor.motor }}</td>
                                <td>{{ model.yanacaq.yanacaq }}</td>
                                <td>{{ model.il.il }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
            
            {% if mehsul.brend.haqqinda or mehsul.brend.sekil %}
            <div class="tab-pane" id="brand">
                <div class="brand-info">
                    <h2>{{ mehsul.brend.adi }} Şirkəti Haqqında</h2>
                    <div class="brand-content">
                        {% if mehsul.brend.sekil %}
                        <div class="brand-image-container">
                            <div class="brand-image">
                                <img src="{{ mehsul.brend.sekil.url }}" alt="{{ mehsul.brend.adi }}" id="brandImage">
                            </div>
                        </div>
                        {% endif %}
                        {% if mehsul.brend.haqqinda %}
                        <div class="brand-description">
                            <p>{{ mehsul.brend.haqqinda }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Oxşar Məhsullar -->
    {% if oxsar_mehsullar %}
    <div class="similar-products">
        <h2>Oxşar Məhsullar</h2>
        <div class="products-grid">
            {% for oxsar in oxsar_mehsullar %}
            <div class="product-card">
                <a href="{% url 'mehsul_haqqinda' oxsar.id %}">
                    <div class="product-image">
                        {% if oxsar.sekil %}
                        <img src="{{ oxsar.sekil.url }}" alt="{{ oxsar.adi }}">
                        {% endif %}
                    </div>
                    <div class="product-info">
                        <h3>{{ oxsar.adi }}</h3>
                        <div class="product-price">{{ oxsar.formatted_qiymet }} ₼</div>
                    </div>
                </a>
                <button class="quick-add-to-cart" data-product-id="{{ oxsar.id }}">
                    <i class="fas fa-cart-plus"></i>
                </button>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>

<!-- Şəkil Böyütmə Modal -->
<div id="imageModal" class="modal">
    <span class="close-modal">&times;</span>
    <img class="modal-content" id="modalImage">
    <div id="caption"></div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/mehsul_haqqinda.js' %}"></script>
{% endblock %} 