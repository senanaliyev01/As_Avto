{% extends 'base.html' %}

{% block title %}Order #{{ order.id }} - AS-AVTO{% endblock %}

{% block content %}
<div class="container">
    <div class="order-header">
        <h2>Order #{{ order.id }}</h2>
        <a href="{% url 'orders' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to Orders
        </a>
    </div>

    <div class="table-container">
        <div class="table-header">
            <div class="header-summary">
                <div class="summary-item">
                    <i class="fas fa-calendar"></i>
                    <span class="summary-label">Order date:</span>
                    <span class="summary-value">{{ order.tarix|date:"d.m.Y H:i" }}</span>
            </div>
                <div class="summary-item">
                    <i class="fas fa-info-circle"></i>
                    <span class="summary-label">Status:</span>
                <span class="status-badge status-{{ order.status|lower }}">
                    {{ order.get_status_display }}
                </span>
            </div>
                <div class="summary-item">
                    <i class="fas fa-truck"></i>
                    <span class="summary-label">Delivery:</span>
                    <span class="delivery-badge">
                        {{ order.get_catdirilma_usulu_display }}
                    </span>
                </div>
                <div class="summary-item">
                    <i class="fas fa-money-bill-wave"></i>
                    <span class="summary-label">Total amount:</span>
                    <span class="summary-value">{{ order.umumi_mebleg }} ₼</span>
                </div>
                <div class="summary-item">
                    <i class="fas fa-check-circle"></i>
                    <span class="summary-label">Paid:</span>
                    <span class="summary-value">{{ order.odenilen_mebleg }} ₼</span>
            </div>
                <div class="summary-item">
                    <i class="fas fa-exclamation-circle"></i>
                    <span class="summary-label">Remaining debt:</span>
                    <span class="summary-value">{{ order.qaliq_borc }} ₼</span>
            </div>
        </div>
    </div>

        <div class="order-items">
    <h3>Ordered Products</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Image</th>
                <th>Code</th>
                <th>Brand Name</th>
                <th>Product Name</th>
                <!-- <th>OEM</th> -->
                <th>Quantity</th>
                <th>Price</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.sifarisitem_set.all %}
            <tr>
                <td>
                    <img src="{{ item.mehsul.sekil.url }}" alt="{{ item.mehsul.adi }} - {{ item.mehsul.brend_kod }} {{ item.mehsul.firma.adi }} {{ item.mehsul.avtomobil.adi }}" title="{{ item.mehsul.adi }} - {{ item.mehsul.brend_kod }}" class="product-image" loading="lazy" onclick="openImageModal('{{ item.mehsul.sekil.url }}')">
                </td>
                <td>{{ item.mehsul.brend_kod }}</td>
                <td>{{ item.mehsul.firma.adi }}</td>
                <td>{{ item.mehsul.adi }}</td>
                <!-- <td>{{ item.mehsul.oem }}</td> -->
                <td>{{ item.miqdar }}</td>
                        <td>{{ item.qiymet }} ₼</td>
                        <td>{{ item.umumi_mebleg }} ₼</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div id="imageModal" class="image-modal">
    <span class="image-modal-close">&times;</span>
    <div class="modal-image-content">
        <img id="modalImage" class="modal-image" src="" alt="Modal Image">
    </div>
</div>

{% endblock %} 